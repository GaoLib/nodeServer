<!DOCTYPE>
<html>
<head>
    <meta charset="utf-8">
    <link href="/libs/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="page-header">
                <h1><%= title %></h1>
                <small>重度科幻迷</small>
            </div>
        </div>
    </div>
    <div class="container">
        <!-- <div class="row"> -->
            <form class="form-horizontal" method="post" name="data" action="/admin/movie/new">
                 <div class="form-group">
                    <label class="col-md-2 control-label" for="douban">豆瓣同步</label>
                    <div class="col-md-10">
                        <input id="douban" class="form-control" type="text" value="">
                    </div>
                </div>
                <input type="hidden" name="movie[_id]" value=''  id="movieId">
                <div class="form-group">
                    <label class="col-md-2 control-label" for="inputCategory">电影分类</label>
                    <div class="col-md-10">
                        <input id="inputCategory" class="form-control" type="text" name="movie[categoryName]" value="">
                    </div>
                </div>
                <div class="form-group" id="categoryShow">
                    <label class="col-md-2 control-label">分类选择</label>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label" for="inputTitle">电影名字</label>
                    <div class="col-md-10">
                        <input id="inputTitle" class="form-control" type="text" name="movie[title]" value="">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label" for="inputDirector">电影导演</label>
                    <div class="col-md-10">
                        <input id="inputDirector" class="form-control" type="text" name="movie[director]" value="">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label" for="inputCountry">国家</label>
                    <div class="col-md-10">
                        <input id="inputCountry" class="form-control" type="text" name="movie[country]" value="">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label" for="inputLanguage">语种</label>
                    <div class="col-md-10">
                        <input id="inputLanguage" class="form-control" type="text" name="movie[language]" value="">
                    </div>
                </div>
                 <div class="form-group">
                    <label class="col-md-2 control-label" for="inputPoster">海报地址</label>
                    <div class="col-md-10">
                        <input id="inputPoster" class="form-control" type="text" name="movie[poster]" value="">
                    </div>
                </div>
                 <div class="form-group">
                    <label class="col-md-2 control-label" for="inputFlash">片源地址</label>
                    <div class="col-md-10">
                        <input id="inputFlash" class="form-control" type="text" name="movie[flash]" value="">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-2 control-label" for="inputYear">上映年份</label>
                    <div class="col-md-10">
                        <input id="inputYear" class="form-control" type="text" name="movie[year]" value="">
                    </div>
                </div>
                 <div class="form-group">
                    <label class="col-md-2 control-label" for="inputSummary">电影简介</label>
                    <div class="col-md-10">
                        <textarea id="inputSummary" class="form-control" name="movie[summary]" value=""></textarea>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-offset-2 col-md-10">
                        <input class="btn btn-default" type="submit" value="录入">
                    </div>
                </div>
            </form>
        <!-- </div> -->
    </div>
</body>
<!-- <script src="/jquery/dist/jquery.min.js" type="text/javascript"></script> -->
<script src="/libs/jquery/dist/jquery.min.js" type="text/javascript"></script>
<script src="/libs/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
<script src="/js/admin.js"></script>
<script>
    let movieData = "<%= JSON.stringify(movie) %>";
    let movie = JSON.parse(movieData.replace(/&#34;/g,'"'))
    let categoriesData = "<%= JSON.stringify(categories) %>";
    let categories = JSON.parse(categoriesData.replace(/&#34;/g,'"'))
    console.log(movie);
    if(movie._id === undefined){
        $('#movieId').val('undefined')
    }else{
        $('#movieId').val(movie._id)
    }
    $('#inputCategory').val(movie.categoryName)
    $('#inputTitle').val(movie.title)
    $('#inputDirector').val(movie.director)
    $('#inputCountry').val(movie.country)
    $('#inputLanguage').val(movie.language)
    $('#inputPoster').val(movie.poster)
    $('#inputFlash').val(movie.flash)
    $('#inputYear').val(movie.year)
    $('#inputSummary').val(movie.summary)
    if(categories.length && categories.length > 0){
        for(let i=0;i<categories.length;i++){
            if(movie._id){
                $('#categoryShow').append('<label class="radio-inline"><input type="radio" name="movie[category]" value="'+categories[i]._id+'" checked='+categories[i]._id.toString() == movie.category.toString()+'>'+categories[i].name+'</label>')
            }else{
                 $('#categoryShow').append('<label class="radio-inline"><input type="radio" name="movie[category]" value="'+categories[i]._id+'">'+categories[i].name+'</label>')
            }
            
        }    
    }
</script>
</html>